---
sidebar_position: 8
---

# 位运算

## 运算规则

JS中,如果对一个数据进行位运算,它首先会将其转换为一个整数(直接把小数抹掉),并且按照32位的整数二进制排列(32位中从左到右数第一位为符号位),**注意这里的32二进制是这个数据的补码**,**即位运算是对这个数据的补码进行操作的,而且得到的结果也是补码**.即位运算就是直接对整数在内存中对应的二进制位进行操作.

:::tip

位运算取整举例:

2.7 -> 2 -> 0000 0000 0000 0000 0000 0000 0000 0010

:::

:::tip

特殊数字位运算取整举例:

NaN -> 0、Infinity -> 0、-Infinity -> 0

:::

## 与运算

- 符号:&

- 写法:整数1 & 整数2

- 规则:将两个整数每一位进行比较,如果都为1,结果为1,否则结果为0.

## 或运算

- 符号:|

- 写法:整数1 | 整数2

- 规则:将两个整数每一位进行比较,如果都为0,结果为0,否则结果为1.

## 否(非)运算

- 符号:~

- 写法:~整数

- 规则:将该整数按位取反.

## 异或运算

- 符号:^

- 写法:数字1 ^ 数字2

- 规则:将数字1和数字2按位比较,不同取1,相同取0

- 应用场景:位的叠加(开关)

    - 添加权限,用|(或)运算

    - 判断权限,用&(与)运算

    - 删除权限,想用|(或)添加再用^(异或)删除

## 左位移

- 符号:<<

- 写法: 数字1 << 数字2

- 规则:将数字1的二进制(**除符号之外**,左移动数字2的次数)

## 右位移

- 符号:>>

- 写法: 数字1 >> 数字2

- 规则:将数字1的二进制(**除符号之外**,右移动数字2的次数)

## 全右位移

- 符号:>>>

- 写法: 数字1 >> 数字2

- 规则:与右位移的区别,在于全右位移会导致符号位跟着位移.

## 举例

- 求~1:

    - 首先求1的补码:正整数的补码为原码:0000 0000 0000 0000 0000 0000 0000 0001

    - 按位取反得到:1111 1111 1111 1111 1111 1111 1111 1110

    - 按取反后得到的补码求原码:1000 0000 0000 0000 0000 0000 0000 0010

    - 换算为十进制为-2.

- 求~-1

    - 首先求-1的补码:1111 1111 1111 1111 1111 1111 1111 1111

    - 按位取反得到:0000 0000 0000 0000 0000 0000 0000 0000

    - 按取反后得到的补码求原码,正整数的原码、反码、补码一样:
        
        0000 0000 0000 0000 0000 0000 0000 0000
        
    - 换算为十进制为0
    
- **i = i | 0**
    
:::tip

 **上面这行代码的意思,就是将i(不管是整数或小数)转为32位整数.**利用这个特性,可以写出一个函数,将任意数值转为32位整数.
    
:::
    
```js
function toInt32(x) {return x | 0;}
function toInt32(x) {return ~~x;}
```